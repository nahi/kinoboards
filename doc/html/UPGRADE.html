<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML i18n//EN">
<html>
<head>
<TITLE>upgrade</TITLE>
</head>
<body>

<h1>
upgrade
</h1>

<p>
Last Update: 2/14/97
</p>

<hr>

<p>
R3.2からのバージョンアップの方法は，
サーバのタイプ
インストール方法は，旧バージョン(R3.2)をインストール済みか，
それとも初めてのインストールなのか，
また，あなたが利用するhttpサーバのCGIの稼働設定に応じ，
以下の3種類にわかれています．

<ul>
<li><a href="#1">1. R3.2をインストール済み</a>
<li>初めてのインストール
<ul>
<li><a href="#2">2. CGIを自分のディレクトリ内に持てる場合</a>
<li><a href="#3">3. CGIは共通のディレクトリに置かなければならない場合</a>
</ul>
</ul>
</p>

<h2><a name="1">1. R3.2からのバージョンアップ</a></h2>

<p>
<ol>
<li>patchファイル(kb10_32_vl.patch)をダウンロードしてください．

<li>release 3.2のkbディレクトリへ行き，システムを止め，
念のためバックアップを取ってください．
もし記事が消えたり，設定が変わって動かなくなっても，責任は取れません(^_^;．
バックアップは必ず取っておいてくださいね．

<blockquote>
<code>
cd ~/public_html/kb<br>
touch .lock.kb<br>
cd ..<br>
tar cvfp kb10_32.tar kb<br>
</code>
</blockquote>

<li>できたkb10_32.tarがバックアップファイルなので，
消さずに残しておいてください．

<li>kbディレクトリに対して，patchを当ててください．

<blockquote>
<code>
cd ~/public_html/kb<br>
cd ..<br>
patch < kb10_32_vl.patch<br>
</code>
</blockquote>

<li>システムのロックを外し，システムが正しく動作することを確認してください．

<blockquote>
<code>
rm .lock.kb<br>
</code>
</blockquote>
</ol>
</p>

<h2><a name="2">2. ユーザがCGIを自分のディレクトリ内に持てる設定</a></h2>

<p>
以下の手順でインストールを行ないます．

<ol>
<li>WWWとしてアクセス可能なディレクトリで，
配布パッケージ(tar + gzip)を展開します．

<blockquote>
<code>
gzip -dc kb10_vl.tar.gz | tar xvfp -
</code>
</blockquote>

<li>注意!: 展開時，tarのpオプションを忘れないようにしてください．

<li>kbというディレクトリが作られ，その中にプログラム本体が展開されます．

<li>サーバの設定によっては，そのディレクトリでCGIプログラムが動くために，
.htaccessというファイルの設定が必要です．
設定方法等は，サーバ管理者の方に問い合わせてください．

<li>展開してできたkbディレクトリに，jcode.plを置きます．
<a href="ftp://ftp.sra.co.jp/pub/lang/perl/sra-scripts/">SRAのftp site</a>
からjcode.pl-2.0を取ってきて，jcode.plという名前で，
他人でも読めるようにパーミッションを設定してください．
jcode.plは(株)SRAの歌代さんが作られたフリーウェアで，
これがなければ日本語のコード変換ができません．

<blockquote>
<code>
chmod a+r jcode.pl
</code>
</blockquote>

<li>kb.cgiの先頭行のperlのpathを，動作環境に合わせて設定します．

<blockquote>
<code>
#!/usr/local/bin/perl → #!/usr/local/bin/GNU/perl5
</code>
</blockquote>

<li>kb.phを書き換えて，きのぼーずをあなたのサイト用に設定し直してください．
特に変更が必要なのは，
<ul>
<li>管理者の名前($MAINT_NAME)
<li>管理者のメイルアドレス($MAINT)
<li>サーバマシンのタイプ($ARCH)
</ul>
です．管理者の名前とメイルアドレスは，忘れずに変更してくださいね．(^_^;

<li>もう動くはずなので，適当なブラウザで，
配布パッケージを展開した時に作られたkbディレクトリにある，
index.htmlにアクセスしてみてください．

</ol>
</p>

<h2><a name="3">3. CGIを共通のディレクトリに置く設定</a></h2>

<p>
この場合，CGI(kb.cgi)と，その他のファイルを置くディレクトリを，
分けなければなりません．
以下の手順でインストールを行ないます．

<ol>
<li>WWWとしてアクセス可能なディレクトリで，
配布パッケージ(tar + gzip)を展開します．

<blockquote>
<code>
gzip -dc kb10_vl.tar.gz | tar xvfp -
</code>
</blockquote>

<li>注意!: 展開時，tarのpオプションを忘れないようにしてください．

<li>kbというディレクトリが作られ，その中にプログラム本体が展開されます．

<li>展開してできたkbディレクトリに，jcode.plを置きます．
<a href="ftp://ftp.sra.co.jp/pub/lang/perl/sra-scripts/">SRAのftp site</a>
からjcode.pl-2.0を取ってきて，jcode.plという名前で，
他人でも読めるようにパーミッションを設定してください．
jcode.plは(株)SRAの歌代さんが作られたフリーウェアで，
これがなければ日本語のコード変換ができません．

<blockquote>
<code>
chmod a+r jcode.pl
</code>
</blockquote>

<li>kb.cgiの先頭行のperlのpathを，動作環境に合わせて設定します．

<blockquote>
<code>
#!/usr/local/bin/perl → #!/usr/local/bin/GNU/perl5
</code>
</blockquote>

<li>kb.cgiを，CGIを置く共通のディレクトリに移します．

<blockquote>
<code>
(共通のディレクトリが/usr/local/etc/htdocs/cgi-bin/の場合)<br>
mv kb.cgi /usr/local/etc/htdocs/cgi-bin/<br>
</code>
</blockquote>

<li>index.htmlを書き換えます．
index.htmlを見ると，「テスト」掲示板へのリンクが，

<blockquote>
&lt;a href=&quot;kb.cgi?b=test&amp;c=v&amp;num=0&quot;&gt;テスト&lt;/a&gt;
</blockquote>

となっていると思います．これを次のように変更してください．

<blockquote>
&lt;a href=&quot;(A)/kb.cgi/(B)?b=test&amp;c=v&amp;num=0&quot;&gt;テスト&lt;/a&gt;
</blockquote>

<ul>
<li>(A): kb.cgiを置いたディレクトリのURL(例えば/cgi-bin)
<li>(B): 配布パッケージを展開した時に作られたkbディレクトリのURL(例えば/~nakahiro/kb)
</ul>

すなわち，「kb.cgi」→「(A)/kb.cgi/(B)」と変更します．上の例なら，

<blockquote>
&lt;a href=&quot;/cgi-bin/kb.cgi/~nakahiro/kb?b=test&amp;c=v&amp;num=0&quot;&gt;テスト&lt;/a&gt;
</blockquote>

になります(上の例でのサンプルが，index.html.cgi-binとして用意してありますので，
参考にしてください))．

<li>同様にして，test/.boardに書かれているkb.cgiへのリンクを，
全て上のように(「kb.cgi」→「(A)/kb.cgi/(B)」のように)書き換えてください．
index.htmlと同様に.board.cgi-binとして用意してあります．参考にしてください．

<li>kb.phを書き換えて，きのぼーずをあなたのサイト用に設定し直してください．
特に変更が必要なのは，
<ul>
<li>管理者の名前($MAINT_NAME)
<li>管理者のメイルアドレス($MAINT)
<li>サーバマシンのタイプ($ARCH)
</ul>
です．管理者の名前とメイルアドレスは，忘れずに変更してくださいね．(^_^;

<li>これで動くはずなので，適当なブラウザで，
配布パッケージを展開した時に作られたkbディレクトリにある，
index.htmlにアクセスしてみてください．
</ol>
</p>

<hr>

<address>
<a href="http://www.kinotrope.co.jp/~nakahiro/kb10.shtml">KINOBOARDS/1.0: Kinoboards Is Network Opened BOARD System</a>.
Copyright (C) 1995, 96, 97
<a href="http://www.kinotrope.co.jp/~nakahiro/">NAKAMURA Hiroshi</a>.
</address>
</body>
</html>
